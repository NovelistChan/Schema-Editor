{"ast":null,"code":"const JSONPATH_JOIN_CHAR = '.';\nexports.JSONPATH_JOIN_CHAR = JSONPATH_JOIN_CHAR;\nexports.lang = 'en_US';\nexports.format = [{\n  name: 'date-time'\n}, {\n  name: 'date'\n}, {\n  name: 'email'\n}, {\n  name: 'hostname'\n}, {\n  name: 'ipv4'\n}, {\n  name: 'ipv6'\n}, {\n  name: 'uri'\n}];\n\nconst _ = require('underscore');\n\nexports.SCHEMA_TYPE = ['string', 'number', 'array', 'object', 'boolean', 'integer'];\nexports.defaultSchema = {\n  string: {\n    type: 'string'\n  },\n  number: {\n    type: 'number'\n  },\n  array: {\n    type: 'array',\n    items: {\n      type: 'string'\n    }\n  },\n  object: {\n    type: 'object',\n    properties: {}\n  },\n  boolean: {\n    type: 'boolean'\n  },\n  integer: {\n    type: 'integer'\n  }\n}; // 防抖函数，减少高频触发的函数执行的频率\n// 请在 constructor 里使用:\n// this.func = debounce(this.func, 400);\n\nexports.debounce = (func, wait) => {\n  let timeout;\n  return function () {\n    clearTimeout(timeout);\n    timeout = setTimeout(func, wait);\n  };\n};\n\nfunction getData(state, keys) {\n  let curState = state;\n\n  for (let i = 0; i < keys.length; i++) {\n    curState = curState[keys[i]];\n  }\n\n  return curState;\n}\n\nexports.getData = getData;\n\nexports.setData = function (state, keys, value) {\n  let curState = state;\n\n  for (let i = 0; i < keys.length - 1; i++) {\n    curState = curState[keys[i]];\n  }\n\n  curState[keys[keys.length - 1]] = value;\n};\n\nexports.deleteData = function (state, keys) {\n  let curState = state;\n\n  for (let i = 0; i < keys.length - 1; i++) {\n    curState = curState[keys[i]];\n  }\n\n  delete curState[keys[keys.length - 1]];\n};\n\nexports.getParentKeys = function (keys) {\n  if (keys.length === 1) return [];\n  let arr = [].concat(keys);\n  arr.splice(keys.length - 1, 1);\n  return arr;\n};\n\nexports.clearSomeFields = function (keys, data) {\n  const newData = Object.assign({}, data);\n  keys.forEach(key => {\n    delete newData[key];\n  });\n  return newData;\n};\n\nfunction getFieldstitle(data) {\n  const requiredtitle = [];\n  Object.keys(data).map(title => {\n    requiredtitle.push(title);\n  });\n  return requiredtitle;\n}\n\nfunction handleSchemaRequired(schema, checked) {\n  // console.log(schema)\n  if (schema.type === 'object') {\n    let requiredtitle = getFieldstitle(schema.properties); // schema.required = checked ? [].concat(requiredtitle) : [];\n\n    if (checked) {\n      schema.required = [].concat(requiredtitle);\n    } else {\n      delete schema.required;\n    }\n\n    handleObject(schema.properties, checked);\n  } else if (schema.type === 'array') {\n    handleSchemaRequired(schema.items, checked);\n  } else {\n    return schema;\n  }\n}\n\nfunction handleObject(properties, checked) {\n  for (var key in properties) {\n    if (properties[key].type === 'array' || properties[key].type === 'object') handleSchemaRequired(properties[key], checked);\n  }\n}\n\nexports.handleSchemaRequired = handleSchemaRequired;\n\nfunction cloneObject(obj) {\n  if (typeof obj === 'object') {\n    if (Array.isArray(obj)) {\n      var newArr = [];\n      obj.forEach(function (item, index) {\n        newArr[index] = cloneObject(item);\n      });\n      return newArr;\n    } else {\n      var newObj = {};\n\n      for (var key in obj) {\n        newObj[key] = cloneObject(obj[key]);\n      }\n\n      return newObj;\n    }\n  } else {\n    return obj;\n  }\n}\n\nexports.cloneObject = cloneObject;","map":{"version":3,"sources":["/Users/novelistchan/Documents/sddm-component/json-schema-editor/src/components/editor/utils.js"],"names":["JSONPATH_JOIN_CHAR","exports","lang","format","name","_","require","SCHEMA_TYPE","defaultSchema","string","type","number","array","items","object","properties","boolean","integer","debounce","func","wait","timeout","clearTimeout","setTimeout","getData","state","keys","curState","i","length","setData","value","deleteData","getParentKeys","arr","concat","splice","clearSomeFields","data","newData","Object","assign","forEach","key","getFieldstitle","requiredtitle","map","title","push","handleSchemaRequired","schema","checked","required","handleObject","cloneObject","obj","Array","isArray","newArr","item","index","newObj"],"mappings":"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","sourcesContent":["const JSONPATH_JOIN_CHAR = '.';\nexports.JSONPATH_JOIN_CHAR = JSONPATH_JOIN_CHAR;\nexports.lang = 'en_US';\nexports.format = [\n  { name: 'date-time' },\n  { name: 'date' },\n  { name: 'email' },\n  { name: 'hostname' },\n  { name: 'ipv4' },\n  { name: 'ipv6' },\n  { name: 'uri' }\n];\nconst _ = require('underscore');\nexports.SCHEMA_TYPE = ['string', 'number', 'array', 'object', 'boolean', 'integer'];\nexports.defaultSchema = {\n  string: {\n    type: 'string'\n  },\n  number: {\n    type: 'number'\n  },\n  array: {\n    type: 'array',\n    items: {\n      type: 'string'\n    }\n  },\n  object: {\n    type: 'object',\n    properties: {}\n  },\n  boolean: {\n    type: 'boolean'\n  },\n  integer: {\n    type: 'integer'\n  }\n};\n\n// 防抖函数，减少高频触发的函数执行的频率\n// 请在 constructor 里使用:\n\n// this.func = debounce(this.func, 400);\nexports.debounce = (func, wait) => {\n  let timeout;\n  return function() {\n    clearTimeout(timeout);\n    timeout = setTimeout(func, wait);\n  };\n};\n\nfunction getData(state, keys) {\n  let curState = state;\n  for (let i = 0; i < keys.length; i++) {\n    curState = curState[keys[i]];\n  }\n  return curState;\n}\n\nexports.getData = getData;\n\nexports.setData = function(state, keys, value) {\n  let curState = state;\n  for (let i = 0; i < keys.length - 1; i++) {\n    curState = curState[keys[i]];\n  }\n  curState[keys[keys.length - 1]] = value;\n};\n\nexports.deleteData = function(state, keys) {\n  let curState = state;\n  for (let i = 0; i < keys.length - 1; i++) {\n    curState = curState[keys[i]];\n  }\n\n  delete curState[keys[keys.length - 1]];\n};\n\nexports.getParentKeys = function(keys) {\n  if (keys.length === 1) return [];\n  let arr = [].concat(keys);\n  arr.splice(keys.length - 1, 1);\n  return arr;\n};\n\nexports.clearSomeFields = function(keys, data) {\n  const newData = Object.assign({}, data);\n  keys.forEach(key => {\n    delete newData[key];\n  });\n  return newData;\n};\n\nfunction getFieldstitle(data) {\n  const requiredtitle = [];\n  Object.keys(data).map(title => {\n    requiredtitle.push(title);\n  });\n\n  return requiredtitle;\n}\n\nfunction handleSchemaRequired(schema, checked) {\n  // console.log(schema)\n  if (schema.type === 'object') {\n    let requiredtitle = getFieldstitle(schema.properties);\n\n    // schema.required = checked ? [].concat(requiredtitle) : [];\n    if (checked) {\n      schema.required = [].concat(requiredtitle);\n    } else {\n      delete schema.required;\n    }\n\n    handleObject(schema.properties, checked);\n  } else if (schema.type === 'array') {\n    handleSchemaRequired(schema.items, checked);\n  } else {\n    return schema;\n  }\n}\n\nfunction handleObject(properties, checked) {\n  for (var key in properties) {\n    if (properties[key].type === 'array' || properties[key].type === 'object')\n      handleSchemaRequired(properties[key], checked);\n  }\n}\n\nexports.handleSchemaRequired = handleSchemaRequired;\n\nfunction cloneObject(obj) {\n  if (typeof obj === 'object') {\n    if (Array.isArray(obj)) {\n      var newArr = [];\n      obj.forEach(function(item, index) {\n        newArr[index] = cloneObject(item);\n      });\n      return newArr;\n    } else {\n      var newObj = {};\n      for (var key in obj) {\n        newObj[key] = cloneObject(obj[key]);\n      }\n      return newObj;\n    }\n  } else {\n    return obj;\n  }\n}\n\nexports.cloneObject = cloneObject;\n"]},"metadata":{},"sourceType":"module"}